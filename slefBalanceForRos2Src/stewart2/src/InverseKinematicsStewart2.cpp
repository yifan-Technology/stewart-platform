#include <chrono>
#include <functional>
#include <memory>
#include <string>

#include <cmath>

#include <eigen3/Eigen/Core>

#include "rclcpp/rclcpp.hpp"
#include "geometry_msgs/msg/twist.hpp"
#include "std_msgs/msg/float32_multi_array.hpp"
#include "trajectory_msgs/msg/joint_trajectory.hpp"
#include "builtin_interfaces/msg/time.hpp"
#include "sensor_msgs/msg/joint_state.hpp"
#include <iostream>

using namespace std::chrono_literals;
using std::placeholders::_1;
#define PI 3.14159265358979323846


class InverseKinematicsStewart2 : public rclcpp::Node  // 2 means ros2
{
  public:
    InverseKinematicsStewart2()
    : Node("InverseKinematicsStewart2")
    {
        radius_p = 84;  
        radius_b = 150; 
        // wb = 30;  //  Grad
        // wp =30;
        height = 218.0;
        period = 100; //收发数据的周期时常，单位ms
        b <<  radius_b*0.70710678,    radius_b*0.70710678,   0, 1,  //45
              radius_b*0.96592582,    radius_b*0.25881904,   0, 1,  //15
              radius_b*0.25881904,    radius_b*-0.96592582,  0, 1,  //285
              radius_b*-0.25881904,   radius_b*-0.96592582,  0, 1,  //255
              radius_b*-0.96592582,   radius_b*0.25881904,   0, 1,  //165
              radius_b*-0.70710678,   radius_b*0.70710678,   0, 1;  //135

        p <<  radius_p*0.25881904,    radius_p*0.96592582,   0, 1,  //75
              radius_p*0.96592582,    radius_p*-0.25881904,  0, 1,  //345
              radius_p*0.70710678,    radius_p*-0.70710678,  0, 1,  //315
              radius_p*-0.70710678,   radius_p*-0.70710678,  0, 1,  //225
              radius_p*-0.96592582,   radius_p*-0.25881904,  0, 1,  //195
              radius_p*-0.25881904,   radius_p*0.96592582,   0, 1;  //105
        
        
        JacobiMatrix << 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0;

        Pose_past <<  0,  0,  height, 0,  0,  0;  //Homepose

      for (int i = 0; i < 6; i++)
        {
            f32ma_msg.data.push_back(0);
            f32ma_msg_vel.data.push_back(0);
        }
         //this publisher_ for test,future can delete
     //publisher_ = this->create_publisher<std_msgs::msg::Float32MultiArray>("/stewart/test_length", 1);
     publisher_ = this->create_publisher<sensor_msgs::msg::JointState>("/Stewart_norm_JointState", 1); 
     subscription_ = this->create_subscription<geometry_msgs::msg::Twist>(
    "/stewart/norm_platform_twist", 1, std::bind(&InverseKinematicsStewart2::callback, this, _1));

}
  private:
//this callback for test,future can delete
    
  // void callback(const geometry_msgs::msg::Twist::SharedPtr msg)
  //   {
  //       float x = msg->linear.x;
  //       float y = msg->linear.y;
  //       float z = msg->linear.z;
  //       float roll = msg->angular.x;
  //       float pitch = msg->angular.y;
  //       float yaw = msg->angular.z;
  //       this->caculatelength(x,y,z,roll,pitch,yaw);
  //       publisher_->publish(f32ma_msg);
  //   }
    
    void callback(const geometry_msgs::msg::Twist::SharedPtr msg)
    {
        float x = msg->linear.x;
        float y = msg->linear.y;
        float z = msg->linear.z;
        float roll = msg->angular.x*PI/180.0;
        float pitch = msg->angular.y*PI/180.0;
        float yaw = msg->angular.z*PI/180.0;
        this->caculatelength(x,y,z,roll,pitch,yaw);
        this->calculatevelocity(x,y,z,roll,pitch,yaw);
        sensor_msgs::msg::JointState pubMsg;
        for (size_t i = 0; i < 6; i++)
        {
        pubMsg.position.push_back(f32ma_msg.data[i]);
        pubMsg.velocity.push_back(f32ma_msg_vel.data[i]);
        }
        publisher_->publish(pubMsg);
    }

    double Deg2Rad(double angular)
    {
          double rad = angular * 3.1415926 / 180;
          return rad;
    }
   
    Eigen::Matrix<float, 4, 4> transformation_matrix(float x, float y, float z, float r, float p, float yaw)
    {
        Eigen::Matrix<float, 4, 4> T;
        T << cos(yaw)*cos(p), -sin(yaw)*cos(r) + cos(yaw)*sin(p)*sin(r),  sin(yaw)*sin(r)+cos(yaw)*sin(p)*cos(r), x,
             sin(yaw)*cos(p),  cos(yaw)*cos(r) + sin(yaw)*sin(p)*sin(r), -cos(yaw)*sin(r)+sin(yaw)*sin(p)*cos(r), y,
                     -sin(p),                             cos(p)*sin(r),                         cos(p)*cos(yaw), z,
                           0,                                         0,                                       0, 1;
        return T;
    }

   // Eigen::Matrix<float, 6, 6> jacobi_matrix(float x, float y, float z, float r, float p, float yaw)
    //{
      //  Eigen::Matrix<float, 6, 6> J;
        // JacobiMatrix << cg0,  cg1,  cg2,  cg3,  cg4,  cg5,
        //                 cg6,  cg7,  cg8,  cg9,  cg10, cg11,
        //                 cg12, cg13, cg14, cg15, cg16, cg17,
        //                 cg18, cg19, cg20, cg21, cg22, cg23,
        //                 cg24, cg25, cg26, cg27, cg28, cg29,
        //                 cg30, cg31, cg32, cg33, cg34, cg35;   
        //   double cg0 = 81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) * fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) / (0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) * pow(pow(fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1);
	// 	double cg1 = fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * pow(pow(fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1);
	// 	double cg2 = fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)* fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * pow(pow(fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1);
	// 	double cg3 = pow(pow(fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) * (0.81144e2 * sin(Wz) * sin(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * sin(Wz) * cos(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * sin(Wx)) * fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) / (0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) + 0.2e1 * fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * (-0.81144e2 * cos(Wz) * sin(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * cos(Wx) - 0.160e3 * cos(Wz) * cos(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * sin(Wx)) * fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) + 0.2e1 * fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (0.81144e2 * cos(Wy) * cos(Wx) - 0.160e3 * cos(Wy) * sin(Wx)) * fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg4 = pow(pow(fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) * (-0.21756e2 * cos(Wz) * sin(Wy) + 0.81144e2 * cos(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * cos(Wy) * cos(Wx)) * fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) / (0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) + 0.2e1 * fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * (-0.21756e2 * sin(Wz) * sin(Wy) + 0.81144e2 * sin(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * cos(Wy) * cos(Wx)) * fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) + 0.2e1 * fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (-0.21756e2 * cos(Wy) - 0.81144e2 * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wy) * cos(Wx)) * fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg5 = pow(pow(fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) * (-0.21756e2 * sin(Wz) * cos(Wy) - 0.81144e2 * cos(Wz) * cos(Wx) - 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx)) * fabs(0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) / (0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.106050e3) + 0.2e1 * fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * (0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx)) * fabs(0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3)) / 0.2e1;
	// 	double cg6 = pow(pow(fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) / (0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3);
	// 	double cg7 = -pow(pow(fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2);
	// 	double cg8 = pow(pow(fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z);
	// 	double cg9 = pow(pow(fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) * (-0.21756e2 * sin(Wz) * sin(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * sin(Wz) * cos(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * sin(Wx)) * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) / (0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) + 0.2e1 * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * (-0.21756e2 * cos(Wz) * sin(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * cos(Wz) * cos(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * sin(Wx)) * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) + 0.2e1 * fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (-0.21756e2 * cos(Wy) * cos(Wx) - 0.160e3 * cos(Wy) * sin(Wx)) * fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg10 = pow(pow(fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) * (-0.81144e2 * cos(Wz) * sin(Wy) - 0.21756e2 * cos(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * cos(Wy) * cos(Wx)) * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) / (0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) + 0.2e1 * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * (0.81144e2 * sin(Wz) * sin(Wy) + 0.21756e2 * sin(Wz) * cos(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * cos(Wy) * cos(Wx)) * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) + 0.2e1 * fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (-0.81144e2 * cos(Wy) + 0.21756e2 * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wy) * cos(Wx)) * fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg11 = pow(pow(fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(-0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) * (-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx)) * fabs(0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) / (0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.144900e3) + 0.2e1 * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * (-0.81144e2 * cos(Wz) * cos(Wy) - 0.21756e2 * sin(Wz) * cos(Wx) + 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx)) * fabs(-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (-0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2)) / 0.2e1;
	// 	double cg12 = pow(pow(fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) / (0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2);
	// 	double cg13 = -pow(pow(fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3);
	// 	double cg14 = pow(pow(fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z);
	// 	double cg15 = pow(pow(fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) * (-0.59388e2 * sin(Wz) * sin(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * sin(Wz) * cos(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * sin(Wx)) * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) / (0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) + 0.2e1 * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * (-0.59388e2 * cos(Wz) * sin(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * cos(Wz) * cos(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * sin(Wx)) * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) + 0.2e1 * fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (-0.59388e2 * cos(Wy) * cos(Wx) - 0.160e3 * cos(Wy) * sin(Wx)) * fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg16 = pow(pow(fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) * (-0.59388e2 * cos(Wz) * sin(Wy) - 0.59388e2 * cos(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * cos(Wy) * cos(Wx)) * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) / (0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) + 0.2e1 * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * (0.59388e2 * sin(Wz) * sin(Wy) + 0.59388e2 * sin(Wz) * cos(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * cos(Wy) * cos(Wx)) * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) + 0.2e1 * fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (-0.59388e2 * cos(Wy) + 0.59388e2 * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wy) * cos(Wx)) * fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg17 = pow(pow(fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(-0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) * (-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx)) * fabs(0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) / (0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x - 0.38850e2) + 0.2e1 * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * (-0.59388e2 * cos(Wz) * cos(Wy) - 0.59388e2 * sin(Wz) * cos(Wx) + 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx)) * fabs(-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (-0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3)) / 0.2e1;
	// 	double cg18 = pow(pow(fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2), 0.2e1) + pow(fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) / (-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2);
	// 	double cg19 = -pow(pow(fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2), 0.2e1) + pow(fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3);
	// 	double cg20 = fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * pow(pow(fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2), 0.2e1) + pow(fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1);
	// 	double cg21 = pow(pow(fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2), 0.2e1) + pow(fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) * (-0.59388e2 * sin(Wz) * sin(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * sin(Wz) * cos(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * sin(Wx)) * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) / (-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) + 0.2e1 * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * (-0.59388e2 * cos(Wz) * sin(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * cos(Wz) * cos(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * sin(Wx)) * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) + 0.2e1 * fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (-0.59388e2 * cos(Wy) * cos(Wx) - 0.160e3 * cos(Wy) * sin(Wx)) * fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg22 = pow(pow(fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2), 0.2e1) + pow(fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) * (0.59388e2 * cos(Wz) * sin(Wy) - 0.59388e2 * cos(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * cos(Wy) * cos(Wx)) * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) / (-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) + 0.2e1 * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * (-0.59388e2 * sin(Wz) * sin(Wy) + 0.59388e2 * sin(Wz) * cos(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * cos(Wy) * cos(Wx)) * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) + 0.2e1 * fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (0.59388e2 * cos(Wy) + 0.59388e2 * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wy) * cos(Wx)) * fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg23 = pow(pow(fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2), 0.2e1) + pow(fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3), 0.2e1) + pow(fabs(0.59388e2 * sin(Wy) - 0.59388e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) * (0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx)) * fabs(-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) / (-0.59388e2 * cos(Wz) * cos(Wy) + 0.59388e2 * sin(Wz) * cos(Wx) - 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.38850e2) + 0.2e1 * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) * (0.59388e2 * cos(Wz) * cos(Wy) - 0.59388e2 * sin(Wz) * cos(Wx) + 0.59388e2 * cos(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx)) * fabs(0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3) / (0.59388e2 * sin(Wz) * cos(Wy) + 0.59388e2 * cos(Wz) * cos(Wx) + 0.59388e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y - 0.144900e3)) / 0.2e1;
	// 	double cg24 = pow(pow(fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3), 0.2e1) + pow(fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) / (-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3);
	// 	double cg25 = -pow(pow(fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3), 0.2e1) + pow(fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2);
	// 	double cg26 = pow(pow(fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3), 0.2e1) + pow(fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z);
	// 	double cg27 = pow(pow(fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3), 0.2e1) + pow(fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) * (-0.21756e2 * sin(Wz) * sin(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * sin(Wz) * cos(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * sin(Wx)) * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) / (-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) + 0.2e1 * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * (-0.21756e2 * cos(Wz) * sin(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * cos(Wz) * cos(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * sin(Wx)) * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) + 0.2e1 * fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (-0.21756e2 * cos(Wy) * cos(Wx) - 0.160e3 * cos(Wy) * sin(Wx)) * fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg28 = pow(pow(fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3), 0.2e1) + pow(fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) * (0.81144e2 * cos(Wz) * sin(Wy) - 0.21756e2 * cos(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * cos(Wy) * cos(Wx)) * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) / (-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) + 0.2e1 * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * (-0.81144e2 * sin(Wz) * sin(Wy) + 0.21756e2 * sin(Wz) * cos(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * cos(Wy) * cos(Wx)) * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) + 0.2e1 * fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (0.81144e2 * cos(Wy) + 0.21756e2 * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wy) * cos(Wx)) * fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg29 = pow(pow(fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3), 0.2e1) + pow(fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2), 0.2e1) + pow(fabs(0.81144e2 * sin(Wy) - 0.21756e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) * (0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx)) * fabs(-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) / (-0.81144e2 * cos(Wz) * cos(Wy) + 0.21756e2 * sin(Wz) * cos(Wx) - 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.144900e3) + 0.2e1 * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) * (0.81144e2 * cos(Wz) * cos(Wy) - 0.21756e2 * sin(Wz) * cos(Wx) + 0.21756e2 * cos(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx)) * fabs(0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2) / (0.81144e2 * sin(Wz) * cos(Wy) + 0.21756e2 * cos(Wz) * cos(Wx) + 0.21756e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) - y + 0.38850e2)) / 0.2e1;
	// 	double cg30 = pow(pow(fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) / (-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3);
	// 	double cg31 = pow(pow(fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3);
	// 	double cg32 = pow(pow(fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z);
	// 	double cg33 = pow(pow(fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) * (0.81144e2 * sin(Wz) * sin(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * cos(Wx) + 0.160e3 * sin(Wz) * cos(Wx) - 0.160e3 * cos(Wz) * sin(Wy) * sin(Wx)) * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) / (-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) + 0.2e1 * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * (-0.81144e2 * cos(Wz) * sin(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * cos(Wx) - 0.160e3 * cos(Wz) * cos(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * sin(Wx)) * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) + 0.2e1 * fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (0.81144e2 * cos(Wy) * cos(Wx) - 0.160e3 * cos(Wy) * sin(Wx)) * fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg34 = pow(pow(fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) * (0.21756e2 * cos(Wz) * sin(Wy) + 0.81144e2 * cos(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * cos(Wy) * cos(Wx)) * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) / (-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) + 0.2e1 * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * (0.21756e2 * sin(Wz) * sin(Wy) + 0.81144e2 * sin(Wz) * cos(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * cos(Wy) * cos(Wx)) * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) + 0.2e1 * fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) * (0.21756e2 * cos(Wy) - 0.81144e2 * sin(Wy) * sin(Wx) - 0.160e3 * sin(Wy) * cos(Wx)) * fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z) / (0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z)) / 0.2e1;
	// 	double cg35 = pow(pow(fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3), 0.2e1) + pow(fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3), 0.2e1) + pow(fabs(0.21756e2 * sin(Wy) + 0.81144e2 * cos(Wy) * sin(Wx) + 0.160e3 * cos(Wy) * cos(Wx) + z), 0.2e1), -0.1e1 / 0.2e1) * (0.2e1 * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) * (0.21756e2 * sin(Wz) * cos(Wy) - 0.81144e2 * cos(Wz) * cos(Wx) - 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wx) - 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx)) * fabs(-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) / (-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx) + x + 0.106050e3) + 0.2e1 * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) * (-0.21756e2 * cos(Wz) * cos(Wy) - 0.81144e2 * sin(Wz) * cos(Wx) + 0.81144e2 * cos(Wz) * sin(Wy) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wx) + 0.160e3 * cos(Wz) * sin(Wy) * cos(Wx)) * fabs(-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3) / (-0.21756e2 * sin(Wz) * cos(Wy) + 0.81144e2 * cos(Wz) * cos(Wx) + 0.81144e2 * sin(Wz) * sin(Wy) * sin(Wx) - 0.160e3 * cos(Wz) * sin(Wx) + 0.160e3 * sin(Wz) * sin(Wy) * cos(Wx) + y - 0.106050e3)) / 0.2e1;
  
       // return J;
  //  }

    void caculatelength(float x, float y, float z, float roll, float pitch, float yaw)
    {
      double data[6];
      bool protect = false;
        Eigen::Matrix<float, 4, 4> T = transformation_matrix(x, y, z + height, roll, pitch, yaw);
        for (size_t i = 0; i < 6; i++)
        {
            Eigen::Matrix<float, 4, 1> length = T*p.row(i).transpose() - b.row(i).transpose();
            data[i] = sqrt(pow(length(0), 2) + pow(length(1), 2) + pow(length(2), 2))-186.0;
        }
        for(size_t i = 0; i < 6; i++)
        {
          if((data[i] > 99.8)||(data[i] < 0.2)){
            protect = true;
          } 
        }
        if(protect==false){
          for(size_t i = 0; i < 6; i++){
          f32ma_msg.data[i]= data[i];
          }
        }
    }
    void calculatevelocity(float x, float y, float z, float roll, float pitch, float yaw){
        Eigen::Matrix<float, 6, 1>velocity_Pose;
        Pose_act <<  x,  y,  z,  roll, pitch,  yaw;
        for (size_t i = 0; i < 6; i++){
          velocity_Pose(i) = (Pose_past(i)-Pose_act(i))/period;
        }
        Eigen::Matrix<float, 6, 1> velocity_Motor = JacobiMatrix * velocity_Pose;
        for(size_t i = 0; i < 6; i++){
          f32ma_msg_vel.data[i]= velocity_Motor(i);
          Pose_past(i)=Pose_act(i);
        }
    }
    float height;
    float radius_p;  
    float radius_b; 
    float period;
    //float wb;  //  Grad
    //float wp;

    Eigen::Matrix<float, 6, 4> b, p;
    Eigen::Matrix<float, 6, 6>JacobiMatrix;
    Eigen::Matrix<float, 6, 1>Pose_past;
    Eigen::Matrix<float, 6, 1>Pose_act;
   //this publisher_ for test,future can delete
    //rclcpp::Publisher<std_msgs::msg::Float32MultiArray>::SharedPtr publisher_;
    rclcpp::Publisher<sensor_msgs::msg::JointState>::SharedPtr publisher_;
    rclcpp::Subscription<geometry_msgs::msg::Twist>::SharedPtr subscription_;
    std_msgs::msg::Float32MultiArray f32ma_msg;
    std_msgs::msg::Float32MultiArray f32ma_msg_vel;
  };

 int main(int argc, char * argv[])
  {
    rclcpp::init(argc, argv);
    rclcpp::spin(std::make_shared<InverseKinematicsStewart2>());
    rclcpp::shutdown();
    return 0;
  }